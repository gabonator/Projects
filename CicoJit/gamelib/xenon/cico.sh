arch -arm64 g++ -std=c++17 ../../cicodis/cicodis/main.cpp -I/opt/homebrew/Cellar/capstone/4.0.2/include/ -L/opt/homebrew/Cellar/capstone/4.0.2/lib -lcapstone.4 -lc++ -o cicodis
#./cicodis dos/XENON2/XENON2.EXE -ctx -recursive -assume_ds 2853 start,14311,14759,137df,172c4,1758f,1655b,10853,10761,17520,170f1,16eef,141e2,1480b,1714a,108b9,10f2b,137ca,11e61,128df,12ab2,13aa7,12a6e,16d22,13a39,1308c,139ee,1091f,10897,13998,141fb,11f4d,13835,13b76,16a0a,125a8,16aad,13bdf,16696,169d0,166a6,16bca,12ad0,16e2c,171dd,12a48,1714d,169c8,13246,13a99,17569,18ca7,17f32,17f79,18e01,189ae,188a9,18c3e,17dde,16284,19f02,19f9a,19fe6,19f4e,121e9,1246d,128b8,14f96,12aa4,180ca,1866d,18114,18126,180f5,187d5,18783,14311,14759,137df,172c4,1758f,1655b,10853,10761,17520,170f1,16eef,141e2,1480b,1714a,108b9,10f2b,137ca,11e61,128df,12ab2,13aa7,12a6e,16d22,13a39,1308c,139ee,1091f,10897,13998,141fb,11f4d,13835,13b76,16a0a,125a8,16aad,13bdf,16696,169d0,166a6,16ac7,16bca,12ad0,16e2c,171dd,12a48,1714d,169c8,13246,13a99,17569,18ca7,17f32,17f79,18e01,189ae,188a9,18c3e,17dde,16284,19f02,19f9a,19fe6,19f4e,121e9,1246d,128b8,14f96,12aa4,180ca,1866d,18114,18126,180f5,187d5,18783 > xenon.cpp
./cicodis dos/XENON2/XENON2.EXE -ctx -recursive start,1f29:164c,1f29:15c4,1f29:125,1f29:11e,1f29:117,1f29:95,1f29:94,1f29:147,1f29:137,1f29:1f3c,1f29:1ea2,1f29:1e00,1f29:1cc4,1f29:1afa,1f29:1a88,1f29:19eb,1f29:19ce,1f29:1955,1f29:18fa,1f29:18cb,1f29:1840,1f29:17a9,1f29:1759,1f29:16fc,1f29:13c3,1f29:135d,1f29:131e,1f29:131e,1f29:1319,1f29:12fd,1f29:12d8,1f29:11f2,1f29:2f5,1f29:202,1f29:15f,1f29:2a,sub_10ed5,10ed9,sub_10edd,sub_10ee1,sub_10ee5,sub_10ee9,10ef1,1758f,1655b,10853,10761,17520,170f1,16eef,141e2,1480b,1714a,108b9,10f2b,137ca,11e61,128df,12ab2,13aa7,12a6e,16d22,13a39,1308c,139ee,1091f,10897,13998,141fb,11f4d,13835,13b76,16a0a,125a8,16aad,13bdf,16696,169d0,166a6,16bca,12ad0,16e2c,171dd,12a48,1714d,169c8,13246,13a99,17569,18ca7,17f32,17f79,18e01,189ae,188a9,18c3e,17dde,16284,19f02,19f9a,19fe6,19f4e,121e9,1246d,128b8,14f96,12aa4,180ca,1866d,18114,18126,180f5,187d5,18783,14311,14759,137df,172c4,1758f,1655b,10853,10761,17520,170f1,16eef,141e2,1480b,1714a,108b9,10f2b,137ca,11e61,128df,12ab2,13aa7,12a6e,16d22,13a39,1308c,139ee,1091f,10897,13998,141fb,11f4d,13835,13b76,16a0a,125a8,16aad,13bdf,16696,169d0,166a6,16ac7,16bca,12ad0,16e2c,171dd,12a48,1714d,169c8,13246,13a99,17569,18ca7,17f32,17f79,18e01,189ae,188a9,18c3e,17dde,16284,19f02,19f9a,19fe6,19f4e,121e9,1246d,128b8,14f96,12aa4,180ca,1866d,18114,18126,180f5,187d5,18783,1f29:02ec,1f29:0c11,1f29:0cb1,1f29:114a,1000:ebd0,1000:ebd7,1f29:1669 > xenon.cpp

grep -v 'push(cs)' xenon.cpp > xenon.tmp
mv xenon.tmp xenon.cpp
node fixapi.js
sed -i '' 's/callIndirect(cs, /callIndirect(/g' xenon.cpp
patch xenon.cpp xenon.patch 
node guard.js
